const CU = '';
const GT = '';
const PW = '';
const VLESS_URL = '';
const SS_URL = '';
let cfg = { socks: [], domains: [] };
let fSha = '';
export default { async fetch(request, env, ctx) { try { const url = new URL(request.url); const from = url.searchParams.get('from'); if (request.method === 'GET') { if (url.pathname === '/') { if (from !== 'vless' && from !== 'ss') return new Response('Not Found', { status: 404 }); return new Response(gHTML(from), { status: 200, headers: { 'Content-Type': 'text/html; charset=utf-8' } }); } if (url.pathname === '/api/config') return await gCfg(); } if (request.method === 'POST' && url.pathname === '/api/config') return await sCfg(request); if (request.method === 'OPTIONS') return new Response(null, { headers: cors() }); return new Response('Not Found', { status: 404 }); } catch (err) { return new Response(err.toString(), { status: 500 }); } } };
function cors() { return { 'Access-Control-Allow-Origin': '*', 'Access-Control-Allow-Methods': 'GET, POST, OPTIONS', 'Access-Control-Allow-Headers': 'Content-Type' }; }
async function gCfg() { try { const h = { 'User-Agent': 'Cloudflare-Worker', 'Accept': 'application/vnd.github.v3+json' }; if (GT) h.Authorization = `token ${GT}`; const r = await fetch(CU, { headers: h }); if (!r.ok) throw new Error(`HTTP ${r.status}`); const d = await r.json(); fSha = d.sha; const decoded = decodeURIComponent(escape(atob(d.content.replace(/\n/g, '')))); cfg = JSON.parse(decoded); return new Response(JSON.stringify({ ...cfg, sha: fSha }), { headers: { 'Content-Type': 'application/json; charset=utf-8', ...cors() } }); } catch (e) { return new Response(JSON.stringify({ error: e.message }), { status: 500, headers: { 'Content-Type': 'application/json', ...cors() } }); } }
async function sCfg(request) { try { const body = await request.json(), { socks, domains, sha } = body; const sl = socks.map(s => '    ' + JSON.stringify(s)).join(',\n'), dl = domains.map(d => '    ' + JSON.stringify(d)).join(',\n'), js = '{\n  "socks": [\n' + sl + '\n  ],\n  "domains": [\n' + dl + '\n  ]\n}', content = btoa(unescape(encodeURIComponent(js))); const r = await fetch(CU, { method: 'PUT', headers: { 'User-Agent': 'Cloudflare-Worker', 'Authorization': `token ${GT}`, 'Content-Type': 'application/json' }, body: JSON.stringify({ message: 'Update config via manager', content, sha }) }); if (!r.ok) { const e = await r.text(); throw new Error(`GitHub API error: ${r.status} ${e}`); } const d = await r.json(); fSha = d.content.sha; return new Response(JSON.stringify({ success: true, sha: fSha }), { headers: { 'Content-Type': 'application/json', ...cors() } }); } catch (e) { return new Response(JSON.stringify({ error: e.message }), { status: 500, headers: { 'Content-Type': 'application/json', ...cors() } }); } }
function gHTML(from) { const backUrl = from === 'vless' ? VLESS_URL + '/' : SS_URL + '/', backName = from === 'vless' ? 'VLESS' : 'SS', chkUrl = from === 'vless' ? VLESS_URL : SS_URL, np = !!(PW && PW.trim()); return `<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>é…ç½®ç®¡ç†</title><style>*{margin:0;padding:0;box-sizing:border-box}:root{--bg:#0d1117;--card:#161b22;--border:#30363d;--text:#e6edf3;--muted:#8b949e;--pri:#238636;--prih:#2ea043;--dan:#da3633;--danh:#f85149;--acc:#58a6ff}body{font-family:system-ui,-apple-system,sans-serif;background:var(--bg);color:var(--text);min-height:100vh;padding:16px;display:flex;align-items:center;justify-content:center}.ct{max-width:1200px;margin:0 auto;width:100%;align-self:flex-start;padding-top:20px}header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;flex-wrap:wrap;gap:10px}h1{font-size:22px;background:linear-gradient(135deg,#58a6ff,#a371f7);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.btn{padding:8px 16px;border:none;border-radius:6px;cursor:pointer;font-size:14px;font-weight:500;transition:all .2s;display:inline-flex;align-items:center;gap:6px;text-decoration:none}.btn-pri{background:var(--pri);color:#fff}.btn-pri:hover{background:var(--prih)}.btn-dan{background:var(--dan);color:#fff}.btn-dan:hover{background:var(--danh)}.btn-out{background:transparent;border:1px solid var(--border);color:var(--text)}.btn-out:hover{border-color:var(--acc);color:var(--acc)}.btn-sm{padding:4px 10px;font-size:12px}.hd-act{display:flex;gap:8px;flex-wrap:wrap}.sec{background:var(--card);border:1px solid var(--border);border-radius:10px;margin-bottom:20px;overflow:hidden}.sec-hd{display:flex;justify-content:space-between;align-items:center;padding:14px 16px;cursor:pointer;user-select:none}.sec-hd:hover{background:rgba(255,255,255,.03)}.sec-tt{font-size:16px;font-weight:600;display:flex;align-items:center;gap:8px}.sec-tt::before{content:'';width:4px;height:18px;background:linear-gradient(180deg,#58a6ff,#a371f7);border-radius:2px}.arrow{transition:transform .3s;font-size:12px;color:var(--muted)}.arrow.open{transform:rotate(90deg)}.sec-bd{max-height:0;overflow:hidden;transition:max-height .3s ease-out}.sec-bd.open{max-height:5000px}.sec-ct{padding:0 16px 16px}.sec-bar{display:flex;gap:8px;margin-bottom:10px;flex-wrap:wrap;align-items:center}.cds{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:10px}.cd{background:var(--bg);border:1px solid var(--border);border-radius:6px;padding:10px;cursor:grab;transition:all .2s;position:relative}.cd:hover{border-color:var(--acc)}.cd.dg{opacity:.5;transform:scale(1.02)}.cd.do{border-color:var(--pri);background:rgba(35,134,54,.1)}.cd.sel{border-color:var(--acc);background:rgba(88,166,255,.1)}.cd.online{border-color:var(--pri)}.cd.offline{border-color:var(--dan)}.cd-ck{position:absolute;top:10px;left:10px;width:16px;height:16px;cursor:pointer}.dm-row{display:flex;align-items:center;gap:8px;padding-left:24px}.dm-txt{font-size:13px;flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;color:var(--acc)}.dm-act{display:flex;gap:4px;flex-shrink:0}.sk-hd{display:flex;justify-content:space-between;align-items:center;padding-left:24px;margin-bottom:6px}.sk-rg{font-weight:600;font-size:14px}.sk-rg.on{color:var(--pri)}.sk-rg.off{color:var(--dan)}.sk-nt{font-size:11px;color:var(--muted);background:var(--card);padding:2px 6px;border-radius:3px}.sk-row{display:flex;align-items:center;gap:8px;padding-left:24px}.sk-cfg{flex:1;font-size:12px;color:var(--muted);padding:6px;background:var(--card);border-radius:4px;cursor:pointer;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.sk-cfg:hover{background:rgba(88,166,255,.1)}.mdl{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.7);z-index:1000;align-items:center;justify-content:center}.mdl.act{display:flex}.mdl-ct{background:var(--card);border:1px solid var(--border);border-radius:10px;padding:20px;width:90%;max-width:450px;max-height:90vh;overflow-y:auto}.mdl-hd{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.mdl-tt{font-size:16px;font-weight:600}.mdl-x{background:none;border:none;color:var(--muted);font-size:22px;cursor:pointer;padding:0;line-height:1}.mdl-x:hover{color:var(--text)}.fg{margin-bottom:14px}.fl{display:block;margin-bottom:4px;font-size:13px;color:var(--muted)}.fi{width:100%;padding:10px;background:var(--bg);border:1px solid var(--border);border-radius:5px;color:var(--text);font-size:13px}.fi:focus{outline:none;border-color:var(--acc)}.fm-act{display:flex;gap:8px;justify-content:flex-end;margin-top:16px}.ld{text-align:center;padding:30px;color:var(--muted)}.tst{position:fixed;bottom:16px;right:16px;background:var(--card);border:1px solid var(--border);border-radius:6px;padding:10px 16px;z-index:1001;transform:translateY(100px);opacity:0;transition:all .3s}.tst.sh{transform:translateY(0);opacity:1}.tst.ok{border-color:var(--pri)}.tst.er{border-color:var(--dan)}.ety{text-align:center;padding:20px;color:var(--muted);font-size:13px}.cnt{font-size:12px;color:var(--muted);margin-left:8px}.file-input{display:none}.lo-box{background:var(--card);border:1px solid var(--border);border-radius:10px;padding:30px;max-width:400px;width:100%;text-align:center}.lo-box h2{margin-bottom:20px;font-size:20px}.lo-box .fi{margin-bottom:12px;text-align:left}.lo-box .btn{width:100%;justify-content:center}.em{color:var(--dan);font-size:13px;padding:10px;background:rgba(218,54,51,.1);border-radius:6px;display:none;margin-bottom:12px}.dt-ct{font-size:13px;word-break:break-all;line-height:1.5;padding:12px;background:var(--bg);border-radius:6px;color:var(--acc);cursor:pointer;transition:all .2s}.dt-ct:hover{background:rgba(88,166,255,.1)}.dt-ct:active{transform:scale(.98)}@media(max-width:600px){header{flex-direction:column;align-items:stretch}h1{text-align:center}.hd-act{justify-content:center}.cds{grid-template-columns:1fr}}</style></head><body><div class="lo-box" id="lo" style="display:${np ? 'block' : 'none'}"><h2>ğŸ” é…ç½®ç®¡ç†ç™»å½•</h2><form id="lf"><input type="password" class="fi" id="pw" placeholder="è¯·è¾“å…¥å¯†ç " required><div class="em" id="em">å¯†ç é”™è¯¯</div><button type="submit" class="btn btn-pri">ç™»å½•</button></form></div><div class="ct" id="mc" style="display:${np ? 'none' : 'block'}"><header><h1>ğŸ”§ GitHub é…ç½®ç®¡ç†</h1><div class="hd-act"><a class="btn btn-out" href="${backUrl}">â¬… è¿”å›${backName}</a><button class="btn btn-out" onclick="lC()">ğŸ”„ åˆ·æ–°</button><button class="btn btn-out" onclick="iF()">ğŸ“¥ å¯¼å…¥</button><button class="btn btn-pri" onclick="sC()">ğŸ’¾ ä¿å­˜</button><input type="file" id="fIn" class="file-input" accept=".json" onchange="hIF(event)"></div></header><div class="sec" id="ds"><div class="sec-hd" onclick="tgS('ds')"><h2 class="sec-tt">ä¼˜é€‰åŸŸå<span class="cnt" id="dc"></span></h2><div style="display:flex;align-items:center;gap:8px"><button class="btn btn-pri btn-sm" onclick="event.stopPropagation();oDM()">+ æ–°å¢</button><span class="arrow" id="ds-ar">â–¶</span></div></div><div class="sec-bd" id="ds-bd"><div class="sec-ct"><div class="sec-bar" id="db"></div><div id="dl" class="cds"><div class="ld">åŠ è½½ä¸­...</div></div></div></div></div><div class="sec" id="ss"><div class="sec-hd" onclick="tgS('ss')"><h2 class="sec-tt">SOCKS ä»£ç†<span class="cnt" id="sc"></span></h2><div style="display:flex;align-items:center;gap:8px"><button class="btn btn-pri btn-sm" onclick="event.stopPropagation();oSM()">+ æ–°å¢</button><span class="arrow" id="ss-ar">â–¶</span></div></div><div class="sec-bd" id="ss-bd"><div class="sec-ct"><div class="sec-bar" id="sb"></div><div id="sl" class="cds"><div class="ld">åŠ è½½ä¸­...</div></div></div></div></div></div><div id="sm" class="mdl"><div class="mdl-ct"><div class="mdl-hd"><h3 class="mdl-tt" id="smt">æ–°å¢ SOCKS</h3><button class="mdl-x" onclick="cSM()">&times;</button></div><form id="sf" onsubmit="svS(event)"><input type="hidden" id="si" value="-1"><div class="fg"><label class="fl">åœ°åŒº *</label><input type="text" class="fi" id="sr" placeholder="ä¾‹å¦‚ï¼šæ–°åŠ å¡" required></div><div class="fg"><label class="fl">é…ç½® *</label><input type="text" class="fi" id="scc" placeholder="user:pass@host:port" required></div><div class="fg"><label class="fl">å¤‡æ³¨</label><input type="text" class="fi" id="sn" placeholder="ä¾‹å¦‚ï¼šVB"></div><div class="fm-act"><button type="button" class="btn btn-out" onclick="cSM()">å–æ¶ˆ</button><button type="submit" class="btn btn-pri">ä¿å­˜</button></div></form></div></div><div id="dm" class="mdl"><div class="mdl-ct"><div class="mdl-hd"><h3 class="mdl-tt" id="dmt">æ–°å¢åŸŸå</h3><button class="mdl-x" onclick="cDM()">&times;</button></div><form id="df" onsubmit="svD(event)"><input type="hidden" id="di" value="-1"><div class="fg"><label class="fl">åŸŸå *</label><input type="text" class="fi" id="dv" placeholder="ä¾‹å¦‚ï¼šcf.example.com" required></div><div class="fm-act"><button type="button" class="btn btn-out" onclick="cDM()">å–æ¶ˆ</button><button type="submit" class="btn btn-pri">ä¿å­˜</button></div></form></div></div><div id="dtm" class="mdl"><div class="mdl-ct"><div class="mdl-hd"><h3 class="mdl-tt">SOCKS è¯¦æƒ…</h3><button class="mdl-x" onclick="cDT()">&times;</button></div><div class="dt-ct" id="dtc"></div></div></div><div id="tst" class="tst"></div><script>const PW='${PW}',np=${np},chkUrl='${chkUrl}';let cfg={socks:[],domains:[]},sha='',sSt={},sSel=new Set(),dSel=new Set(),skChkd=false;function cl(){return!np||sessionStorage.getItem('mng_l')==='1'}function sm(){document.getElementById('lo').style.display='none';document.getElementById('mc').style.display='block'}const lf=document.getElementById('lf');if(lf){lf.addEventListener('submit',e=>{e.preventDefault();if(document.getElementById('pw').value===PW){sessionStorage.setItem('mng_l','1');sm();lC();document.getElementById('em').style.display='none'}else{document.getElementById('em').style.display='block';document.getElementById('pw').value=''}})}function tgS(id){const bd=document.getElementById(id+'-bd'),ar=document.getElementById(id+'-ar'),isOpen=bd.classList.toggle('open');ar.classList.toggle('open',isOpen);if(id==='ss'&&isOpen&&!skChkd&&cfg.socks.length>0){skChkd=true;setTimeout(chkAll,300)}}async function lC(){try{tst('åŠ è½½ä¸­...','');const r=await fetch('/api/config');if(!r.ok)throw new Error('åŠ è½½å¤±è´¥');const d=await r.json();if(d.error)throw new Error(d.error);cfg={socks:d.socks||[],domains:d.domains||[]};sha=d.sha||'';sSt={};sSel.clear();dSel.clear();skChkd=false;rA();tst('åŠ è½½æˆåŠŸ','ok')}catch(e){tst('åŠ è½½å¤±è´¥: '+e.message,'er');document.getElementById('sl').innerHTML='<div class="ety">åŠ è½½å¤±è´¥</div>';document.getElementById('dl').innerHTML='<div class="ety">åŠ è½½å¤±è´¥</div>'}}async function sC(){try{tst('ä¿å­˜ä¸­...','');const r=await fetch('/api/config',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({socks:cfg.socks,domains:cfg.domains,sha})});const d=await r.json();if(d.error)throw new Error(d.error);sha=d.sha;tst('ä¿å­˜æˆåŠŸï¼','ok')}catch(e){tst('ä¿å­˜å¤±è´¥: '+e.message,'er')}}function iF(){document.getElementById('fIn').click()}function hIF(e){const f=e.target.files[0];if(!f)return;const r=new FileReader();r.onload=ev=>{try{const d=JSON.parse(ev.target.result);if(d.socks&&Array.isArray(d.socks))cfg.socks=[...cfg.socks,...d.socks];if(d.domains&&Array.isArray(d.domains))cfg.domains=[...cfg.domains,...d.domains];rA();tst('å¯¼å…¥æˆåŠŸ: '+(d.socks?.length||0)+' SOCKS, '+(d.domains?.length||0)+' åŸŸå','ok')}catch(er){tst('å¯¼å…¥å¤±è´¥: JSONæ ¼å¼é”™è¯¯','er')}e.target.value=''};r.readAsText(f)}function rA(){rS();rD()}function msk(c){try{const ai=c.lastIndexOf('@');if(ai>0){const ap=c.substring(0,ai),ci=ap.indexOf(':');if(ci>0){const u=ap.substring(0,ci);return u.substring(0,2)+'***:***@***:***'}return '***:***'}return '***:***'}catch(e){return '***:***'}}function mskD(d){try{const p=d.split('.');if(p.length>=2){const f=p[0],l=p[p.length-1];return f+'.****.'+l}return d.substring(0,3)+'****'}catch(e){return '****'}}function tgSS(i){sSel.has(i)?sSel.delete(i):sSel.add(i);rS()}function tgDS(i){dSel.has(i)?dSel.delete(i):dSel.add(i);rD()}function saS(){cfg.socks.forEach((_,i)=>sSel.add(i));rS()}function caS(){sSel.clear();rS()}function dsS(){if(sSel.size===0)return tst('è¯·å…ˆé€‰æ‹©','er');if(!confirm('ç¡®å®šåˆ é™¤é€‰ä¸­çš„ '+sSel.size+' é¡¹å—ï¼Ÿ'))return;const a=[...sSel].sort((a,b)=>b-a);a.forEach(i=>cfg.socks.splice(i,1));sSel.clear();rS();tst('å·²åˆ é™¤ '+a.length+' é¡¹','ok')}function saD(){cfg.domains.forEach((_,i)=>dSel.add(i));rD()}function caD(){dSel.clear();rD()}function dsD(){if(dSel.size===0)return tst('è¯·å…ˆé€‰æ‹©','er');if(!confirm('ç¡®å®šåˆ é™¤é€‰ä¸­çš„ '+dSel.size+' é¡¹å—ï¼Ÿ'))return;const a=[...dSel].sort((a,b)=>b-a);a.forEach(i=>cfg.domains.splice(i,1));dSel.clear();rD();tst('å·²åˆ é™¤ '+a.length+' é¡¹','ok')}function rS(){const c=document.getElementById('sl'),b=document.getElementById('sb');document.getElementById('sc').textContent='('+cfg.socks.length+')';b.innerHTML=cfg.socks.length>0?'<button class="btn btn-out btn-sm" onclick="saS()">å…¨é€‰</button><button class="btn btn-out btn-sm" onclick="caS()">å–æ¶ˆ</button><button class="btn btn-dan btn-sm" onclick="dsS()">åˆ é™¤('+sSel.size+')</button>':'';if(!cfg.socks||cfg.socks.length===0){c.innerHTML='<div class="ety">æš‚æ— é…ç½®</div>';return}c.innerHTML=cfg.socks.map((s,i)=>{const st=sSt[i],cls=st==='on'?'online':st==='off'?'offline':'',rgCls=st==='on'?'on':st==='off'?'off':'';return \`<div class="cd \${sSel.has(i)?'sel':''} \${cls}" draggable="true" data-t="socks" data-i="\${i}"><input type="checkbox" class="cd-ck" \${sSel.has(i)?'checked':''} onclick="event.stopPropagation();tgSS(\${i})"><div class="sk-hd"><span class="sk-rg \${rgCls}">\${esc(s.region)}</span>\${s.note?\`<span class="sk-nt">\${esc(s.note)}</span>\`:''}</div><div class="sk-row"><span class="sk-cfg" onclick="event.stopPropagation();sDT(\${i})">\${msk(s.config)}</span><button class="btn btn-out btn-sm" onclick="event.stopPropagation();eS(\${i})">ç¼–è¾‘</button></div></div>\`}).join('');aDE(c,'socks')}function rD(){const c=document.getElementById('dl'),b=document.getElementById('db');document.getElementById('dc').textContent='('+cfg.domains.length+')';b.innerHTML=cfg.domains.length>0?'<button class="btn btn-out btn-sm" onclick="saD()">å…¨é€‰</button><button class="btn btn-out btn-sm" onclick="caD()">å–æ¶ˆ</button><button class="btn btn-dan btn-sm" onclick="dsD()">åˆ é™¤('+dSel.size+')</button>':'';if(!cfg.domains||cfg.domains.length===0){c.innerHTML='<div class="ety">æš‚æ— é…ç½®</div>';return}c.innerHTML=cfg.domains.map((d,i)=>\`<div class="cd dm-cd \${dSel.has(i)?'sel':''}" draggable="true" data-t="domains" data-i="\${i}"><div class="dm-row"><input type="checkbox" class="cd-ck" style="position:static" \${dSel.has(i)?'checked':''} onclick="event.stopPropagation();tgDS(\${i})"><span class=\"dm-txt sk-cfg\" onclick=\"event.stopPropagation();dDT(\${i})\">\${mskD(d.domain)}</span><div class="dm-act"><button class="btn btn-out btn-sm" onclick="event.stopPropagation();eD(\${i})">ç¼–è¾‘</button></div></div></div>\`).join('');aDE(c,'domains')}function aDE(ct,t){const cs=ct.querySelectorAll('.cd');cs.forEach(cd=>{cd.addEventListener('dragstart',e=>{cd.classList.add('dg');e.dataTransfer.setData('text/plain',cd.dataset.i);e.dataTransfer.effectAllowed='move'});cd.addEventListener('dragend',()=>cd.classList.remove('dg'));cd.addEventListener('dragover',e=>{e.preventDefault();cd.classList.add('do')});cd.addEventListener('dragleave',()=>cd.classList.remove('do'));cd.addEventListener('drop',e=>{e.preventDefault();cd.classList.remove('do');const fi=parseInt(e.dataTransfer.getData('text/plain')),ti=parseInt(cd.dataset.i);if(fi!==ti){const a=cfg[t],[m]=a.splice(fi,1);a.splice(ti,0,m);if(t==='socks'){sSel.clear();rS()}else{dSel.clear();rD()}tst('é¡ºåºå·²è°ƒæ•´','ok')}})})}function sDT(i){const s=cfg.socks[i],el=document.getElementById('dtc');document.querySelector('#dtm .mdl-tt').textContent='SOCKS è¯¦æƒ…';el.textContent=s.config;el.onclick=()=>{navigator.clipboard.writeText(s.config).then(()=>tst('å·²å¤åˆ¶','ok')).catch(()=>tst('å¤åˆ¶å¤±è´¥','er'))};document.getElementById('dtm').classList.add('act')}function dDT(i){const d=cfg.domains[i],el=document.getElementById('dtc');document.querySelector('#dtm .mdl-tt').textContent='åŸŸåè¯¦æƒ…';el.textContent=d.domain;el.onclick=()=>{navigator.clipboard.writeText(d.domain).then(()=>tst('å·²å¤åˆ¶','ok')).catch(()=>tst('å¤åˆ¶å¤±è´¥','er'))};document.getElementById('dtm').classList.add('act')}function cDT(){document.getElementById('dtm').classList.remove('act')}async function chkAll(){tst('æ£€æµ‹ä¸­...','');for(let i=0;i<cfg.socks.length;i++){try{const r=await fetch(chkUrl+'/api/check-socks?index='+i);const d=await r.json();sSt[i]=d.status==='online'?'on':'off'}catch(e){sSt[i]='off'}rS()}tst('æ£€æµ‹å®Œæˆ','ok')}function oSM(i=-1){document.getElementById('si').value=i;document.getElementById('smt').textContent=i===-1?'æ–°å¢ SOCKS':'ç¼–è¾‘ SOCKS';if(i>=0){const s=cfg.socks[i];document.getElementById('sr').value=s.region||'';document.getElementById('scc').value=s.config||'';document.getElementById('sn').value=s.note||''}else document.getElementById('sf').reset();document.getElementById('sm').classList.add('act')}function cSM(){document.getElementById('sm').classList.remove('act')}function svS(e){e.preventDefault();const i=parseInt(document.getElementById('si').value),it={region:document.getElementById('sr').value.trim(),config:document.getElementById('scc').value.trim(),note:document.getElementById('sn').value.trim()};if(i>=0)cfg.socks[i]=it;else cfg.socks.push(it);rS();cSM();tst(i>=0?'å·²æ›´æ–°':'å·²æ·»åŠ ','ok')}function eS(i){oSM(i)}function oDM(i=-1){document.getElementById('di').value=i;document.getElementById('dmt').textContent=i===-1?'æ–°å¢åŸŸå':'ç¼–è¾‘åŸŸå';if(i>=0)document.getElementById('dv').value=cfg.domains[i].domain||'';else document.getElementById('df').reset();document.getElementById('dm').classList.add('act')}function cDM(){document.getElementById('dm').classList.remove('act')}function svD(e){e.preventDefault();const i=parseInt(document.getElementById('di').value),it={domain:document.getElementById('dv').value.trim()};if(i>=0)cfg.domains[i]=it;else cfg.domains.push(it);rD();cDM();tst(i>=0?'å·²æ›´æ–°':'å·²æ·»åŠ ','ok')}function eD(i){oDM(i)}function dD(i){if(confirm(\`ç¡®å®šåˆ é™¤ "\${cfg.domains[i].domain}" å—ï¼Ÿ\`)){cfg.domains.splice(i,1);dSel.clear();rD();tst('å·²åˆ é™¤','ok')}}function esc(s){return s?s.replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])):''}function tst(m,t=''){const e=document.getElementById('tst');e.textContent=m;e.className='tst sh '+(t==='ok'?'ok':t==='er'?'er':'');setTimeout(()=>e.classList.remove('sh'),3000)}window.onload=()=>{if(cl()){sm();lC()}};document.querySelectorAll('.mdl').forEach(m=>m.addEventListener('click',e=>{if(e.target===m)m.classList.remove('act')}));</script></body></html>`; }
